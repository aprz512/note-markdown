## Java核心技术（卷一）笔记



### 第一章

**面向对象设计**：

用木匠打个比方，一个“面向对象的”木匠始终关注的是所制作的椅子，第二位才是所使用的工具；一个“非面向对象”的木匠首先考虑的是所用的工具。

**即时编译**：

解释虚拟机指令肯定会比全速运行机器指令慢很多。然而，虚拟机有一个选项，可以将执行最频繁的字节码序列翻译成机器码，这一过程被称为即时编译。

字节码可以（在运行时刻）动态的翻译成对应运行这个应用的特定CPU机器码。

即时编译器还可以消除函数调用（即“内联”）。

### 第三章

**一个简单的Java应用程序**：

根据Java语言规范，Java虚拟机将从指定类中的main方法开始执行。

不过，当main方法不是public时，有些版本的Java解释器也可以执行Java应用。这是因为Java虚拟机规范并没有要求main方法一定是public。这个问题已经得到了修复，在Java SE 1.4及以后的版本中强制main方法时public的。

**整形**：

从Java 7开始，加上前缀0B或者0b就可以写二进制数。例如：0b1001就是9。同样，从Java 7开始，还可以为数字字面量加下划线，如用1_000_000表示一百万。

**浮点类型**：

所有”非数值“的值都认为是不同的。

```java
if (x == Double.NaN) // is never true
```

可以使用 Double.isNaN() 来判断（长得帅的肯定会戳进去看一下源码，很有意思哦）。

浮点数不适用于无法接受舍入误差的金融计算中。例如，

```java
double result = 2.0 - 1.9; // result = 0.10000000000000009
```

这是因为二进制无法精确的表示 1/10。

可移植性是Java的设计目标之一。无论在哪个虚拟机上运行，同一运算应该得到同样的结果。对于浮点数的算术运算，实现这样的可移植性是相当困难的。double类型使用64位储存一个数值，而有些处理器使用80位浮点寄存器。这些寄存器增加了中间过程的计算精度。例如：

```java
ddoble w = x * y / z;
```

使用严格浮点计算，截断中间数，可以了解一下 strictfp 关键字。

**char类型**：

转义字符\u可以出现在加引号的字符常量或字符串之外（其他的转义字符不行）。例如：

```java
public static void main(String\u005B\u005D args)
```

\u005B\u005D其实就是[]，所以上面的代码就是程序的入口main函数。

Unicode转义字符会在解析代码之前得到处理，举个吓死人的例子：

```java
// file in c:\user
```

当你在代码里面加上这行注释的时候，点击运行按钮就会发现，编译过不了！！！我的理解是先会将文件里面的转义字符全部处理一下，当处理到这行注释的时候，发现了 `\u` 会当成转义字符来处理，但是 `\u` 后面的字符不合法，所以就报错了。

Unicode的基本平面，辅助平面，码点的概念，可以看维基百科。

一个字符可能有多个码点，一个char只能表示一个码点。

**运算符**：

整数被0除将会产生一个异常，而浮点数被0除将会得到无穷大或者NaN结果。

**数值类型之间的转换**：

两个操作数有一个是 double ，则两个数按照 double 处理，

否则，有一个是 float，则两个数按照 float 处理，

否则，有一个是 long，则两个数按照 long 处理，

否则，两个数按照 int 处理。

```java
byte a = 1;
byte b = 2;
byte c = a + b; // error
```

```java
byte a = 1;
a += 1; // ok，因为 += 会自动进行强制转换
```

**位运算符**：

处理整形类型时，可以直接对组成整形数值的各个位完成操作，浮点数不行。

```
int a = 1;
a << 1; // ok
double b = 3;
b << 1; // error
```

位移运算符的右操作数要完成模32的运算（如果左操作是long型，则需要模64）。

```java
1 << 35 相当于 1 << 3
```

**字符串**：

编译器可以让字符串共享，只有字符串常量是共享的，+或者substring等操作产生的结果并不是共享的。

**格式化输出**：

使用参数索引来对一个参数进行多次格式化：

```java
System.out.print("%1$s %2$tB %2$te %2$tY", "Due date:", new Date());
```

可以看到第二个索引对`new Date()`参数格式化了多次。使用`<`标志也可以达到同样的效果。

```java
System.out.print("%s %tB %<te %<tY", "Due date:", new Date());
```

